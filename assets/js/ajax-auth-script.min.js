var $ = jQuery.noConflict();
jQuery(document).ready(function (e) {
  e("body").on("submit", "form#login, form#register", function (a) {
    e("p.status", this).show().text(ajax_auth_object.loadingmessage),
      (email = ""),
      (action = "ajaxlogin_custom"),
      (username = e("form#login #username").val()),
      (password = e("form#login #password").val()),
      "register" == e(this).attr("id") &&
        ((action = "ajaxregister_custom"),
        (username = e("#signup_name").val()),
        (password = e("#signup_password").val()),
        (email = e("#signup_email").val()));
    (ctrl = e(this)),
      e.ajax({
        type: "POST",
        dataType: "json",
        url: ajax_auth_object.ajaxurl,
        data: {
          action: action,
          username: username,
          password: password,
          email: email,
        },
        beforeSend: function () {
          $(".btn-login").prop("disabled", true);
          $(".btn-register").prop("disabled", true);
        },
        success: function (a) {
          if (!a.loggedin) $(".btn-login").prop("disabled", false);
          if (!a.registered) $(".btn-register").prop("disabled", false);
          e("p.status", ctrl).text(a.message),
            1 == a.loggedin
              ? (document.location.reload())
              : "register" == ctrl;
          1 == a.registered
            ? (document.location.reload())
            : "register" == ctrl;
        },
      }),
      a.preventDefault();
  }),
    e("body").on("submit", "form#forgot_password", function (a) {
      return (
        e("p.status", this).show().text(ajax_auth_object.loadingmessage),
        (ctrl = e(this)),
        e.ajax({
          type: "POST",
          dataType: "json",
          url: ajax_auth_object.ajaxurl,
          data: {
            action: "ajaxforgotpassword",
            user_login: e("#user_login").val(),
          },
          success: function (a) {
            e("p.status", ctrl).text(a.message);
          },
        }),
        a.preventDefault(),
        !1
      );
    });
});

function showRegisterForm() {
  $(".loginBox").fadeOut("fast", function () {
    $(".registerBox").fadeIn("fast"),
      $(".forgotPasswordBox").fadeOut("fast"),
      $(".login-footer").fadeOut("fast", function () {
        $(".register-footer").fadeIn("fast");
      }),
      $(".modal-title").html(ajax_auth_object.languages.register_with);
  }),
    $(".error").removeClass("alert alert-danger").html("");
}
function showForgotPasswordForm() {
  $(".loginBox").fadeOut("fast", function () {
    $(".forgotPasswordBox").fadeIn("fast"),
      $(".register-footer").fadeOut("fast", function () {
        $(".login-footer").fadeIn("fast");
      }),
      $(".modal-title").html(ajax_auth_object.languages.forgotpassword);
  }),
    $(".error").removeClass("alert alert-danger").html("");
}
function showLoginForm() {
  $("#loginModal .registerBox").fadeOut("fast", function () {
    $(".loginBox").fadeIn("fast"),
      $(".forgotPasswordBox").fadeOut("fast"),
      $(".register-footer").fadeOut("fast", function () {
        $(".login-footer").fadeIn("fast");
      }),
      $(".modal-title").html(ajax_auth_object.languages.login_with);
  }),
    $(".error").removeClass("alert alert-danger").html("");
}
function openLoginModal() {
  showLoginForm();
  a =
    '<div class="modal fade login" id="loginModal">    <div class="modal-dialog login animated">        <div class="modal-content">            <div class="modal-header">                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>                <h4 class="modal-title">' +
    ajax_auth_object.languages.login +
    '</h4>            </div>            <div class="modal-body">                <div class="content">                             <div class="error"></div>                    <div class="form loginBox">                        <form id="login" method="post" action="" accept-charset="UTF-8">                            <p class="status"></p>                            <input id="username" class="form-control" type="text" placeholder="' +
    ajax_auth_object.languages.username +
    '" name="username" required>                            <input id="password" class="form-control" type="password" placeholder="' +
    ajax_auth_object.languages.password +
    '" name="password" required>                                                                              <input class="btn btn-default btn-login" type="submit" value="' +
    ajax_auth_object.languages.login +
    '">                        </form>                    </div>                </div>                <div class="content registerBox" style="display:none;">                    <div class="form">                        <form id="register" method="post" html="{:multipart=>true}" data-remote="true" action="" accept-charset="UTF-8">                            <p class="status"></p>                            <input id="signup_name" class="form-control" type="text" placeholder="' +
    ajax_auth_object.languages.username +
    '" name="username" class="required">                            <input id="signup_email" class="form-control" type="text" placeholder="' +
    ajax_auth_object.languages.email +
    '" name="email" required>                            <input id="signup_password" class="form-control" type="password" placeholder="' +
    ajax_auth_object.languages.password +
    '" name="password">                                                                    <input class="btn btn-default btn-register" type="submit" value="' +
    ajax_auth_object.languages.create_account +
    '">                        </form>                    </div>                </div>                <div class="content forgotPasswordBox" style="display:none;">                                 </div>            </div>            <div class="modal-footer">                <div class="forgot login-footer">                <span><a href="javascript:showRegisterForm();">' +
    ajax_auth_object.languages.register +
    ' </a></span>             </div>                <div class="forgot register-footer" style="display:none">                    <span>' +
    ajax_auth_object.languages.already_account +
    '</span>                    <a href="javascript:showLoginForm();">' +
    ajax_auth_object.languages.login +
    "</a>                </div>            </div>        </div>    </div></div>";
  $("body").append(a),
    setTimeout(function () {
      var a;
      $("#loginModal").modal("show"),
        $("#loginModal").on("hidden.bs.modal", function (a) {
          $(this).remove();
        }),
        null !== halim_ajax_login &&
          (halim_ajax_login_custom.facebook_login_url &&
            ((a = $("a#facebook_login")
              .attr("href")
              .replace("javascript:showNotice();", "")),
            $("a#facebook_login").attr(
              "href",
              a + halim_ajax_login_custom.facebook_login_url
            )),
          halim_ajax_login_custom.google_login_url &&
            ((a = $("a#google_login")
              .attr("href")
              .replace("javascript:showNotice();", "")),
            $("a#google_login").attr(
              "href",
              a + halim_ajax_login_custom.google_login_url
            )),
          halim_ajax_login_custom.twitter_login_url &&
            ((a = $("a#twitter_login")
              .attr("href")
              .replace("javascript:showNotice();", "")).replace(
              "javascript:;",
              ""
            ),
            $("a#twitter_login").attr(
              "href",
              a + halim_ajax_login_custom.twitter_login_url
            )));
    }, 200);
}
function openRegisterModal() {
  showRegisterForm(),
    setTimeout(function () {
      $("#loginModal").modal("show");
    }, 200);
}
function showNotice() {
  alert("Comming soon...");
}
